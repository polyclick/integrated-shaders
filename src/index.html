<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">

    <meta property="og:type"        content="website" />
    <meta property="og:url"         content="" />
    <meta property="og:title"       content="" />
    <meta property="og:image"       content="" />
    <meta property="og:description" content="" />

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="">

    <title>three.js scene</title>

    <link rel="stylesheet" href="css/app.css" charset="utf-8">
</head>
<body>
    <div class="track">
      <a href="https://soundcloud.com/slumberjack-music/horus-1" target="_blank">Now playing: <b>Horus</b> by <b>Slumberjack</b></a>
    </div>

    <script id="vertexShader" type="shader">
      #ifdef GL_ES
      precision highp float;
      #endif

      uniform vec2 u_resolution;
      uniform float u_time;
      uniform float u_volume;
      uniform float u_fft[128];
      varying vec2 vUv;

      void main() {
          vUv = uv;

          // deform a sin wave to show a sawtooth on its path
          // enter here to see:
          // http://patriciogonzalezvivo.com/2015/thebookofshaders/glossary/?search=pow
          // y = sin(x) + (fract(x * 10.0) / 2.0);

          //float strength = 25.0 + (25.0 * pow(u_volume, 3.0 ));
          //float strength = 25.0 + (25.0 * pow(u_fft[10], 3.0 ));

          float strength = 25.0;
          float speed = u_time * 2.0;

          // http://stackoverflow.com/questions/11635791/using-uint8array-data-in-webgl-shader
          //float height = 10.0;
          //float freq = 1.0 * u_fft[10];
          //float displacement = abs(mod(position.y * freq, height) - (height / 2.0)) - (height / 4.0);
          float wave = sin(position.y * 0.05 + speed) * strength;
          float zPosition = wave;

          // http://www.gamedev.net/topic/607082-sine-wave-shader/
          gl_Position = projectionMatrix *
                        modelViewMatrix *
                        vec4(position.x, position.y, zPosition, 1.0);
      }
    </script>
    <script id="fragmentShader" type="shader">
      #ifdef GL_ES
      precision highp float;
      #endif

      #define PI 3.14159265359

      uniform vec2 u_resolution;
      uniform float u_time;
      uniform float u_volume;
      uniform float u_fft[128];
      varying vec2 vUv;

      float plot(vec2 st, float pct){
        return  smoothstep( pct-0.02, pct, st.y) -
                smoothstep( pct, pct+0.02, st.y);
      }

      void main() {
          vec2 st = -1.0 + 2.0 * vUv;
          //vec2 st = gl_FragCoord.xy/u_resolution;

          float y = sign(cos(st.x * 35.0));

          vec3 color = vec3(y);

          //float pct = plot(st,y);
          //color = (1.0-pct)*color+pct*vec3(0.0,1.0,0.0);

          gl_FragColor = vec4(color, 1.0);
      }
    </script>

    <!-- google analytics -->
    <!-- todo: enter tracking identifier -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'XX-XXXXXXXX-X', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- contributing to the webgl stats tracker -->
    <script src="//cdn.webglstats.com/stat.js" defer="defer" async="async"></script>

    <!-- source code -->
    <script src="lib/system.js"></script>
    <script src="config.js"></script>
    <script>System.import('./js/app')</script>
</body>
</html>
